# syntax=docker/dockerfile:1

FROM debian:trixie-slim

ENV DEBIAN_FRONTEND=noninteractive
ENV GNUMAKEFLAGS="-j2 --no-print-directory --output-sync=target"
ENV MAKEFLAGS="-j2 --no-print-directory --output-sync=target"
ENV RSTUDIO_PANDOC=/usr/bin
ENV TZ=Europe/Berlin

SHELL ["/bin/bash", "-Eeuxo", "pipefail", "-c"]

COPY docker_scripts /docker_scripts

# Disable compiler warnings when R compiles packages from source.
ENV EXTRA_CXXFLAGS=-w
COPY config/Makevars /root/.R/Makevars

RUN /docker_scripts/install_apt_packages.sh
RUN /docker_scripts/install_R_packages.R
